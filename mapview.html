Procédure AUTOIT et manuel d’instruction Qliksense

Sommaire :
1)	Procédure autoit Reuters (p 2)
2)	Procédure autoit Qliksense (p 2-3)
3)	User et mot de passe Qliksense (p 3)
4)	Défilement des cartes sur Qliksense et google (p 3)
5)	En cas de problème (p 3)
6)	Créer une feuille sur QlikSense (p 3-5)
7)	Ajouter une feuille au récit (p 5-6)
8)	Ajouter une feuille au script autoit (p 6 -7)
9)	Définir une vue par défaut (p 7)
10)	Etape pour déployer Mapview sur un autre pc (p 7-8)
11)	Faire une pause 
12)	Définition des sleep


















1)Procédure autoit Reuters :
ATTENTION : NE PAS TOUCHER AU CLAVIER OU A LA SOURIS LORS DU DEROULEMENT DU PROGRAMME TOUT EST FAIT AUTOMATIQUEMENT.
Le programme Autoit sert à la mise en route de Reuters puis une ouverture du fichier Excel afin d’obtenir les données le plus récentes sur les bateaux (Localisation).
1)	Ouverture de REUTERS. (Si l’utilisateur n’est pas le Sign in il le fait automatiquement)
2)	Laisse le temps à Reuters de se lancer. (20 sec)
3)	Ouvre le fichier Excel avec les différents DWT
4)	Refresh le fichier Excel afin d’avoir les données les plus récentes
5)	Ferme le fichier Excel 
6)	Ferme Reuters

Google drive :
Tous les fichiers sont mis dans Google drive de sorte que l’accès soit plus simple.
Chemin pour accéder au fichier Excel :
Google Drive>Dreyfus_qlikview_app>MAPVIEW>xls>Mapview_Reuters

2)Procédure autoit Qliksense:
ATTENTION : NE PAS TOUCHER AU CLAVIER OU A LA SOURIS LORS DU DEROULEMENT DU PROGRAMME TOUT EST FAIT AUTOMATIQUEMENT.
ATTENTION NE LANCEZ PAS IMMEDIATEMENT L’AUTOIT AU LORSQUE VOUS ALLUMEZ L’ORDINATEUR ATTENDEZ QU’IL SOIT BIEN CONNECTEZ AU RESEAU.
Le programme sert à afficher le déplacement des bateaux en temps réel sur différentes cartes qui défile automatiquement.
 Allumer l’ordinateur une fois sur le bureau cliquer sur l’icône du nom de Mapview.exe puis laisser tourner le programme.
Laissez le temps au programme de s’exécuter une action ne prend pas plus d’une minute si vous trouvez que l’écran reste figé trop longtemps attendez. Le temps est long en raison de la connexion qui peut parfois être plus lente que prévu. 
Déroulement du programme :
1)	Lancement de l’application Google Wind (10-35 sec)
2)	Lancement de QlikSense (10-30 sec)
3)	Lancement de l’application Mapview (10-15 sec)
4)	Lancement du récit (10-15 sec)
5)	Durée du diaporama (1800 sec pour 200 sec par slide)
6)	TOUTES LES 6 HEURES : Chargement des données (40-60 sec)
7)	Durée de l’affichage des cartes winds et waves (100 sec)
8)	Temps que le boucle d’affichage des cartes met : environ 1920 sec 
 

3) User et mot de passe Qliksense: user : Mapview2019
				     MDP : Mapview2019
4)Défilement des cartes sur Qliksense et google 
Si une carte QlikSense passe alors que vous êtes en train de la regarder il suffit d’appuyer sur CONTROL puis la touche flèche de gauche du clavier a l’inverse si vous voulez passer à la slide suivante appuyez CONTROL puis sur flèche de droite.
Pour les cartes google il suffit de faire {CTRL}+{TAB}
  
ATTENTION APPPUYEZ SUR LES FLECHES UNIQUEMENT SI LES CARTES S’AFFICHE SINON NE TOUCHEZ A RIEN.
5) En cas de problème
En cas de problème avec l’exécution de l’Autoit fermer le programme en appuyant sur la touche ECHAP, éteignez l’ordinateur (ainsi que toutes les applications ouvertes. Sauvegardez si nécessaire) et rallumez-le normalement puis relancer le programme.
Si vous êtes sur une tablette Windows ou il y’a la touche FN faites : fn puis echap
Si vous voulez stopper le programme sans fermer les applications appuyer la touche {$}.
6)Créer une feuille sur QlikSense
Comment ajouter une feuille sur QlikSense :
1)	Une fois conneté vous allez tomber sur cet écran cliquer sur la seul icone bleu que vous voyez
 
2)	Vous tombez ensuite sur cet écran :
 
Cliquez sur créer une feuille nommez la et appuyez sur entrer puis cliquez dessus.



3)	Vous arrivez ici cliquez sur Editer puis graphique>Carte faites glisser la carte sur la feuillle

 
4)	Une fois ici faites le design de votre carte comme vous le souhaitez à l’aide de Paramètres de la carte et Aspect
 
5)	Enfin allez dans couche>ajouter une couche>*Sélectionnez le type de couche*>Ajouter et choisissez la table que vous voulez (Prendre les tables qui commence par Vessel)
 
6)Enfin dans Emplacement>champ de l’Emplacement>GPS

7) Enfin si avez sélectionnez vessel cape at sea par exemple vous devez tomber sur ça  
  
Remarque : vous pouvez ajouter plusieurs couche sur une même carte.
7) Ajouter une feuille au récit (pas obligatoire) :
Une fois creér vous pouvez mettre votre feuille dans un récit.
1) cliquez sur l’onglet récit puis bibliothéque de feuille
 
Sélectionnez la feuille que vous voulez et elle se mettra dans votre récit.
Remarque : pour supprimer la feuille du récit faite un clic droit sur votre feuille et clique sur supprimer (faire le clic droit là où il y’a toutes les feuilles sur une colonne à gauche).

8) Ajouter une feuille au script autoit:
1)taper script dans la barre de recherche et cliquez sur cette icone
 
2)

2) Vous tombez ensuite sur ce script descendez jusqu’à la boucle while


 

3) Enfin il vous suffit de suivre les instructions misent en commentaire
 
Remarque : pour supprimer la vue de l’autoit il vous suffit de supprimer les lignes de script écrites dans l’étapes précédentes. 

9) Définir une vue par défaut :
Il suffit d’aller dans QlikSense Choisissez la carte que vous voulez modifier, mettez la vue que vous désirez puis cliquer sur paramètres de la carte> (si ce n’est pas déjà fait décochée la case zoom automatique) définir la vue par défaut>
Si la case zoom automatique est déjà décochée faites simplement : effacer la vue par défaut>définir la vue par défaut
10) Etape pour déployer Mapview sur un autre pc :
1)	Installer Qliksense et Autoit (gratuit)
2)	Installer google drive sur le pc ( mail :ldacetramax  @gmail.com , mdp : !password !22
3)	Une fois les fichiers installés ouvrer le google drive et qlik sense
4)	Connecté vous a qliksense vous devriez voir cet écran 
5)	Faites copier-coller du fichier Mapview_V4.qvf situer dans google drive :
Dreyfus_qlikview_app->MAPVIEW->Sense->Apps 
Puis copier le dans le disque local : C:\Users\*utilisateur*\Documents\Qlik\Sense\Apps
6)	Allez ensuite sur le dossier autoit de google drive :
Dreyfus_qlikview_app->MAPVIEW->Autoit
Faites glisser l’icône ci-dessous avec écrit mapview.exe sur le bureau.
 
7)	Fermer toutes les applications et cliquer sur l’icone que vous venez de mettre sur le bureau.
11) Faire une pause
Pour faire une pause il suffit d’appuyer sur la barre d’espace quand vous avez fini, appuyer a nouveau dessus. (Voir code ci-dessous ligne 75 de l’autoit)
Func _Pause()
    Local Static $bPaused = False
    $bPaused = Not $bPaused
    While $bPaused
        Sleep(333)
    WEnd

